<!-- Generated by Cython 0.19.1 on Sun Jul 28 23:33:46 2013 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.19.1 on Sun Jul 28 23:33:46 2013
<p>Raw output: <a href="fasthist.c">fasthist.c</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #cython: embedsignature=True</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":1
 * #cython: embedsignature=True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import numpy as np
 * cimport numpy as np
 */
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2")'> 2: import numpy as np</pre>
<pre id='line2' class='code' style='background-color: #FFFF8d'>
  /* "hist2d\fasthist.pyx":2
 * #cython: embedsignature=True
 * import numpy as np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport numpy as np
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__np, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: cimport numpy as np</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: </pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line5")'> 5: from numpy import ma</pre>
<pre id='line5' class='code' style='background-color: #FFFF57'>
  /* "hist2d\fasthist.pyx":5
 * cimport numpy as np
 * 
 * from numpy import ma             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__ma));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__ma));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__ma));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s__ma);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__ma, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: </pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: </pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line8")'> 8: def getVersion():</pre>
<pre id='line8' class='code' style='background-color: #FFFF62'>
/* "hist2d\fasthist.pyx":8
 * 
 * 
 * def getVersion():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     __version__="0.2"
 *     return "version: %s" % __version__
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_getVersion(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_v___version__ = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("getVersion", 0);

  /* "hist2d\fasthist.pyx":8
 * 
 * 
 * def getVersion():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     __version__="0.2"
 *     return "version: %s" % __version__
 */
  __pyx_k_tuple_21 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s____version__));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_21);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_21));

  /* "hist2d\fasthist.pyx":8
 * 
 * 
 * def getVersion():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     __version__="0.2"
 *     return "version: %s" % __version__
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_1getVersion, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__getVersion, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_22 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_23, __pyx_n_s__getVersion, 8, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line9")'> 9:     __version__="0.2"</pre>
<pre id='line9' class='code' style='background-color: #FFFFe7'>
  /* "hist2d\fasthist.pyx":9
 * 
 * def getVersion():
 *     __version__="0.2"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return "version: %s" % __version__
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
  __pyx_v___version__ = ((PyObject *)__pyx_kp_s_1);
</pre><pre class='line' style='background-color: #FFFF11' onclick='toggleDiv("line10")'> 10:     return "version: %s" % __version__</pre>
<pre id='line10' class='code' style='background-color: #FFFF11'>
  /* "hist2d\fasthist.pyx":10
 * def getVersion():
 *     __version__="0.2"
 *     return "version: %s" % __version__             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_2), __pyx_v___version__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.getVersion", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v___version__);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6hist2d_8fasthist_3fullhist(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6hist2d_8fasthist_2fullhist[] = "fullhist(dataVecPy, int numbins, float mindata, float maxdata, int missingLowValue, int missingHighValue)\n\n       given a list or numpy array dataVecPy, bin values in\n       numbins between mindata and maxsdata, returning a\n       python dictionary with edges, centers, counts and\n       \"fullbins\", which is a vector of the same length as\n       dataVecPy with the bin of every datapoint\n    ";
static PyMethodDef __pyx_mdef_6hist2d_8fasthist_3fullhist = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("fullhist"), (PyCFunction)__pyx_pw_6hist2d_8fasthist_3fullhist, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_6hist2d_8fasthist_2fullhist)};
static PyObject *__pyx_pw_6hist2d_8fasthist_3fullhist(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dataVecPy = 0;
  int __pyx_v_numbins;
  float __pyx_v_mindata;
  float __pyx_v_maxdata;
  int __pyx_v_missingLowValue;
  int __pyx_v_missingHighValue;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("fullhist (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__dataVecPy,&__pyx_n_s__numbins,&__pyx_n_s__mindata,&__pyx_n_s__maxdata,&__pyx_n_s__missingLowValue,&__pyx_n_s__missingHighValue,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dataVecPy)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__numbins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__mindata)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__maxdata)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__missingLowValue)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__missingHighValue)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fullhist") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_dataVecPy = values[0];
    __pyx_v_numbins = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_numbins == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_mindata = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_mindata == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_maxdata = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_maxdata == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_missingLowValue = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_missingLowValue == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_missingHighValue = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_missingHighValue == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fullhist", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.fullhist", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6hist2d_8fasthist_2fullhist(__pyx_self, __pyx_v_dataVecPy, __pyx_v_numbins, __pyx_v_mindata, __pyx_v_maxdata, __pyx_v_missingLowValue, __pyx_v_missingHighValue);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: </pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: </pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line13")'> 13: def  fullhist(object dataVecPy, int numbins, float mindata,</pre>
<pre id='line13' class='code' style='background-color: #FFFF5e'>
/* "hist2d\fasthist.pyx":13
 * 
 * 
 * def  fullhist(object dataVecPy, int numbins, float mindata,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *               float maxdata,int missingLowValue,int missingHighValue):
 *     """
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_2fullhist(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dataVecPy, int __pyx_v_numbins, float __pyx_v_mindata, float __pyx_v_maxdata, int __pyx_v_missingLowValue, int __pyx_v_missingHighValue) {
  PyArrayObject *__pyx_v_dataVec = 0;
  double *__pyx_v_dataPtr;
  float __pyx_v_binsize;
  __pyx_t_5numpy_int64_t __pyx_v_numPts;
  PyArrayObject *__pyx_v_outcounts = 0;
  Py_ssize_t *__pyx_v_countPtr;
  PyArrayObject *__pyx_v_bincenters = 0;
  float *__pyx_v_centerPtr;
  PyArrayObject *__pyx_v_binedges = 0;
  float *__pyx_v_edgePtr;
  PyArrayObject *__pyx_v_savebins = 0;
  Py_ssize_t *__pyx_v_savebinsPtr;
  float __pyx_v_fbin;
  long __pyx_v_lowcount;
  long __pyx_v_highcount;
  int __pyx_v_i;
  int __pyx_v_ibin;
  PyObject *__pyx_v_retval = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_bincenters;
  __Pyx_Buffer __pyx_pybuffer_bincenters;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_binedges;
  __Pyx_Buffer __pyx_pybuffer_binedges;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dataVec;
  __Pyx_Buffer __pyx_pybuffer_dataVec;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_outcounts;
  __Pyx_Buffer __pyx_pybuffer_outcounts;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_savebins;
  __Pyx_Buffer __pyx_pybuffer_savebins;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("fullhist", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVecPy);
  __pyx_pybuffer_dataVec.pybuffer.buf = NULL;
  __pyx_pybuffer_dataVec.refcount = 0;
  __pyx_pybuffernd_dataVec.data = NULL;
  __pyx_pybuffernd_dataVec.rcbuffer = &__pyx_pybuffer_dataVec;
  __pyx_pybuffer_outcounts.pybuffer.buf = NULL;
  __pyx_pybuffer_outcounts.refcount = 0;
  __pyx_pybuffernd_outcounts.data = NULL;
  __pyx_pybuffernd_outcounts.rcbuffer = &__pyx_pybuffer_outcounts;
  __pyx_pybuffer_bincenters.pybuffer.buf = NULL;
  __pyx_pybuffer_bincenters.refcount = 0;
  __pyx_pybuffernd_bincenters.data = NULL;
  __pyx_pybuffernd_bincenters.rcbuffer = &__pyx_pybuffer_bincenters;
  __pyx_pybuffer_binedges.pybuffer.buf = NULL;
  __pyx_pybuffer_binedges.refcount = 0;
  __pyx_pybuffernd_binedges.data = NULL;
  __pyx_pybuffernd_binedges.rcbuffer = &__pyx_pybuffer_binedges;
  __pyx_pybuffer_savebins.pybuffer.buf = NULL;
  __pyx_pybuffer_savebins.refcount = 0;
  __pyx_pybuffernd_savebins.data = NULL;
  __pyx_pybuffernd_savebins.rcbuffer = &__pyx_pybuffer_savebins;

  /* "hist2d\fasthist.pyx":13
 * 
 * 
 * def  fullhist(object dataVecPy, int numbins, float mindata,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *               float maxdata,int missingLowValue,int missingHighValue):
 *     """
 */
  __pyx_k_tuple_25 = <span class='py_c_api'>PyTuple_Pack</span>(24, ((PyObject *)__pyx_n_s__dataVecPy), ((PyObject *)__pyx_n_s__numbins), ((PyObject *)__pyx_n_s__mindata), ((PyObject *)__pyx_n_s__maxdata), ((PyObject *)__pyx_n_s__missingLowValue), ((PyObject *)__pyx_n_s__missingHighValue), ((PyObject *)__pyx_n_s__dataVec), ((PyObject *)__pyx_n_s__dataPtr), ((PyObject *)__pyx_n_s__binsize), ((PyObject *)__pyx_n_s__numPts), ((PyObject *)__pyx_n_s__outcounts), ((PyObject *)__pyx_n_s__countPtr), ((PyObject *)__pyx_n_s__bincenters), ((PyObject *)__pyx_n_s__centerPtr), ((PyObject *)__pyx_n_s__binedges), ((PyObject *)__pyx_n_s__edgePtr), ((PyObject *)__pyx_n_s__savebins), ((PyObject *)__pyx_n_s__savebinsPtr), ((PyObject *)__pyx_n_s__fbin), ((PyObject *)__pyx_n_s__lowcount), ((PyObject *)__pyx_n_s__highcount), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__ibin), ((PyObject *)__pyx_n_s__retval));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_25);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_25));

  /* "hist2d\fasthist.pyx":13
 * 
 * 
 * def  fullhist(object dataVecPy, int numbins, float mindata,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *               float maxdata,int missingLowValue,int missingHighValue):
 *     """
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_3fullhist, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__fullhist, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_26 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(6, 0, 24, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_23, __pyx_n_s__fullhist, 13, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14:               float maxdata,int missingLowValue,int missingHighValue):</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15:     """</pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16:        given a list or numpy array dataVecPy, bin values in</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17:        numbins between mindata and maxsdata, returning a</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18:        python dictionary with edges, centers, counts and</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19:        "fullbins", which is a vector of the same length as</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20:        dataVecPy with the bin of every datapoint</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21:     """</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line22")'> 22:     dataVecPy=np.ascontiguousarray(dataVecPy,dtype=np.float64)</pre>
<pre id='line22' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":22
 *        dataVecPy with the bin of every datapoint
 *     """
 *     dataVecPy=np.ascontiguousarray(dataVecPy,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.double_t,ndim=1] dataVec = dataVecPy
 *     cdef double* dataPtr=<code><</code>double*>dataVec.data
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVecPy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dataVecPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_dataVecPy);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dataVecPy);
  __pyx_v_dataVecPy = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line23")'> 23:     cdef np.ndarray[np.double_t,ndim=1] dataVec = dataVecPy</pre>
<pre id='line23' class='code' style='background-color: #FFFF9f'>
  /* "hist2d\fasthist.pyx":23
 *     """
 *     dataVecPy=np.ascontiguousarray(dataVecPy,dtype=np.float64)
 *     cdef np.ndarray[np.double_t,ndim=1] dataVec = dataVecPy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef double* dataPtr=<code><</code>double*>dataVec.data
 *     cdef float binsize=(maxdata-mindata)/numbins
 */
  if (!(likely(((__pyx_v_dataVecPy) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_dataVecPy, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_v_dataVecPy);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dataVec.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_dataVec = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dataVec.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_dataVec.diminfo[0].strides = __pyx_pybuffernd_dataVec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dataVec.diminfo[0].shape = __pyx_pybuffernd_dataVec.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVecPy);
  __pyx_v_dataVec = ((PyArrayObject *)__pyx_v_dataVecPy);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24:     cdef double* dataPtr=&lt;double*&gt;dataVec.data</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":24
 *     dataVecPy=np.ascontiguousarray(dataVecPy,dtype=np.float64)
 *     cdef np.ndarray[np.double_t,ndim=1] dataVec = dataVecPy
 *     cdef double* dataPtr=<code><</code>double*>dataVec.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float binsize=(maxdata-mindata)/numbins
 *     cdef np.int64_t numPts=dataVec.shape[0]
 */
  __pyx_v_dataPtr = ((double *)__pyx_v_dataVec->data);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line25")'> 25:     cdef float binsize=(maxdata-mindata)/numbins</pre>
<pre id='line25' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":25
 *     cdef np.ndarray[np.double_t,ndim=1] dataVec = dataVecPy
 *     cdef double* dataPtr=<code><</code>double*>dataVec.data
 *     cdef float binsize=(maxdata-mindata)/numbins             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.int64_t numPts=dataVec.shape[0]
 *     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)
 */
  __pyx_t_7 = (__pyx_v_maxdata - __pyx_v_mindata);
  if (unlikely(__pyx_v_numbins == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_binsize = (__pyx_t_7 / __pyx_v_numbins);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26:     cdef np.int64_t numPts=dataVec.shape[0]</pre>
<pre id='line26' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":26
 *     cdef double* dataPtr=<code><</code>double*>dataVec.data
 *     cdef float binsize=(maxdata-mindata)/numbins
 *     cdef np.int64_t numPts=dataVec.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)
 *     cdef Py_ssize_t* countPtr=<code><</code>Py_ssize_t*> outcounts.data
 */
  __pyx_v_numPts = (__pyx_v_dataVec->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line27")'> 27:     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)</pre>
<pre id='line27' class='code' style='background-color: #FFFF26'>
  /* "hist2d\fasthist.pyx":27
 *     cdef float binsize=(maxdata-mindata)/numbins
 *     cdef np.int64_t numPts=dataVec.shape[0]
 *     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Py_ssize_t* countPtr=<code><</code>Py_ssize_t*> outcounts.data
 *     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numbins);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_outcounts.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_outcounts = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_outcounts.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_outcounts.diminfo[0].strides = __pyx_pybuffernd_outcounts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_outcounts.diminfo[0].shape = __pyx_pybuffernd_outcounts.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_outcounts = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:     cdef Py_ssize_t* countPtr=&lt;Py_ssize_t*&gt; outcounts.data</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":28
 *     cdef np.int64_t numPts=dataVec.shape[0]
 *     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)
 *     cdef Py_ssize_t* countPtr=<code><</code>Py_ssize_t*> outcounts.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)
 *     cdef float* centerPtr=<code><</code>float*> bincenters.data
 */
  __pyx_v_countPtr = ((Py_ssize_t *)__pyx_v_outcounts->data);
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line29")'> 29:     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)</pre>
<pre id='line29' class='code' style='background-color: #FFFF26'>
  /* "hist2d\fasthist.pyx":29
 *     cdef np.ndarray[np.int64_t,ndim=1] outcounts = np.zeros([numbins,],dtype=np.int64)
 *     cdef Py_ssize_t* countPtr=<code><</code>Py_ssize_t*> outcounts.data
 *     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float* centerPtr=<code><</code>float*> bincenters.data
 *     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numbins);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_5));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_5));
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, ((PyObject *)__pyx_n_s__dtype), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_bincenters.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_bincenters = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_bincenters.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_bincenters.diminfo[0].strides = __pyx_pybuffernd_bincenters.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_bincenters.diminfo[0].shape = __pyx_pybuffernd_bincenters.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_bincenters = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30:     cdef float* centerPtr=&lt;float*&gt; bincenters.data</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":30
 *     cdef Py_ssize_t* countPtr=<code><</code>Py_ssize_t*> outcounts.data
 *     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)
 *     cdef float* centerPtr=<code><</code>float*> bincenters.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)
 *     cdef float* edgePtr=<code><</code>float*> binedges.data
 */
  __pyx_v_centerPtr = ((float *)__pyx_v_bincenters->data);
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line31")'> 31:     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)</pre>
<pre id='line31' class='code' style='background-color: #FFFF26'>
  /* "hist2d\fasthist.pyx":31
 *     cdef np.ndarray[np.float32_t,ndim=1] bincenters=np.zeros([numbins,],dtype=np.float32)
 *     cdef float* centerPtr=<code><</code>float*> bincenters.data
 *     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float* edgePtr=<code><</code>float*> binedges.data
 *     cdef np.ndarray[np.int64_t,ndim=1] savebins=np.zeros([numPts,],dtype=np.int64)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_numbins + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_binedges.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_binedges = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_binedges.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_binedges.diminfo[0].strides = __pyx_pybuffernd_binedges.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_binedges.diminfo[0].shape = __pyx_pybuffernd_binedges.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_binedges = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32:     cdef float* edgePtr=&lt;float*&gt; binedges.data</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":32
 *     cdef float* centerPtr=<code><</code>float*> bincenters.data
 *     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)
 *     cdef float* edgePtr=<code><</code>float*> binedges.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] savebins=np.zeros([numPts,],dtype=np.int64)
 *     cdef Py_ssize_t* savebinsPtr=<code><</code>Py_ssize_t*> savebins.data
 */
  __pyx_v_edgePtr = ((float *)__pyx_v_binedges->data);
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line33")'> 33:     cdef np.ndarray[np.int64_t,ndim=1] savebins=np.zeros([numPts,],dtype=np.int64)</pre>
<pre id='line33' class='code' style='background-color: #FFFF29'>
  /* "hist2d\fasthist.pyx":33
 *     cdef np.ndarray[np.float32_t,ndim=1] binedges=np.zeros([numbins+1,],dtype=np.float32)
 *     cdef float* edgePtr=<code><</code>float*> binedges.data
 *     cdef np.ndarray[np.int64_t,ndim=1] savebins=np.zeros([numPts,],dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Py_ssize_t* savebinsPtr=<code><</code>Py_ssize_t*> savebins.data
 *     cdef float fbin
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_to_py_npy_int64(__pyx_v_numPts);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_3), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_savebins.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_savebins = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_savebins.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_savebins.diminfo[0].strides = __pyx_pybuffernd_savebins.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_savebins.diminfo[0].shape = __pyx_pybuffernd_savebins.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_savebins = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34:     cdef Py_ssize_t* savebinsPtr=&lt;Py_ssize_t*&gt; savebins.data</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":34
 *     cdef float* edgePtr=<code><</code>float*> binedges.data
 *     cdef np.ndarray[np.int64_t,ndim=1] savebins=np.zeros([numPts,],dtype=np.int64)
 *     cdef Py_ssize_t* savebinsPtr=<code><</code>Py_ssize_t*> savebins.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float fbin
 *     cdef long lowcount=0, highcount=0
 */
  __pyx_v_savebinsPtr = ((Py_ssize_t *)__pyx_v_savebins->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:     cdef float fbin</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36:     cdef long lowcount=0, highcount=0</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":36
 *     cdef Py_ssize_t* savebinsPtr=<code><</code>Py_ssize_t*> savebins.data
 *     cdef float fbin
 *     cdef long lowcount=0, highcount=0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,ibin
 *     for i in range(numPts):
 */
  __pyx_v_lowcount = 0;
  __pyx_v_highcount = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37:     cdef int i,ibin</pre>
<pre id='line37' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:     for i in range(numPts):</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":38
 *     cdef long lowcount=0, highcount=0
 *     cdef int i,ibin
 *     for i in range(numPts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         fbin =  ((dataPtr[i] - mindata) / binsize)
 *         if fbin <code><</code> 0:
 */
  __pyx_t_12 = __pyx_v_numPts;
  for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line39")'> 39:         fbin =  ((dataPtr[i] - mindata) / binsize)</pre>
<pre id='line39' class='code' style='background-color: #FFFFaa'>
    /* "hist2d\fasthist.pyx":39
 *     cdef int i,ibin
 *     for i in range(numPts):
 *         fbin =  ((dataPtr[i] - mindata) / binsize)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if fbin <code><</code> 0:
 *             lowcount+=1
 */
    __pyx_t_14 = ((__pyx_v_dataPtr[__pyx_v_i]) - __pyx_v_mindata);
    if (unlikely(__pyx_v_binsize == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_fbin = (__pyx_t_14 / __pyx_v_binsize);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40:         if fbin &lt; 0:</pre>
<pre id='line40' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":40
 *     for i in range(numPts):
 *         fbin =  ((dataPtr[i] - mindata) / binsize)
 *         if fbin <code><</code> 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             lowcount+=1
 *             savebinsPtr[i]=missingLowValue
 */
    __pyx_t_15 = ((__pyx_v_fbin <code><</code> 0.0) != 0);
    if (__pyx_t_15) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:             lowcount+=1</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":41
 *         fbin =  ((dataPtr[i] - mindata) / binsize)
 *         if fbin <code><</code> 0:
 *             lowcount+=1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             savebinsPtr[i]=missingLowValue
 *             continue
 */
      __pyx_v_lowcount = (__pyx_v_lowcount + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42:             savebinsPtr[i]=missingLowValue</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":42
 *         if fbin <code><</code> 0:
 *             lowcount+=1
 *             savebinsPtr[i]=missingLowValue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             continue
 *         if fbin > (numbins - 1):
 */
      (__pyx_v_savebinsPtr[__pyx_v_i]) = __pyx_v_missingLowValue;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:             continue</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":43
 *             lowcount+=1
 *             savebinsPtr[i]=missingLowValue
 *             continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if fbin > (numbins - 1):
 *             highcount += 1
 */
      goto __pyx_L3_continue;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44:         if fbin &gt; (numbins - 1):</pre>
<pre id='line44' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":44
 *             savebinsPtr[i]=missingLowValue
 *             continue
 *         if fbin > (numbins - 1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             highcount += 1
 *             savebinsPtr[i] = missingHighValue
 */
    __pyx_t_15 = ((__pyx_v_fbin > (__pyx_v_numbins - 1)) != 0);
    if (__pyx_t_15) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:             highcount += 1</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":45
 *             continue
 *         if fbin > (numbins - 1):
 *             highcount += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             savebinsPtr[i] = missingHighValue
 *             continue
 */
      __pyx_v_highcount = (__pyx_v_highcount + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46:             savebinsPtr[i] = missingHighValue</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":46
 *         if fbin > (numbins - 1):
 *             highcount += 1
 *             savebinsPtr[i] = missingHighValue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             continue
 *         ibin=<code><</code>int>fbin
 */
      (__pyx_v_savebinsPtr[__pyx_v_i]) = __pyx_v_missingHighValue;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:             continue</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":47
 *             highcount += 1
 *             savebinsPtr[i] = missingHighValue
 *             continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ibin=<code><</code>int>fbin
 *         countPtr[ibin]+=1
 */
      goto __pyx_L3_continue;
      goto __pyx_L6;
    }
    __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48:         ibin=&lt;int&gt;fbin</pre>
<pre id='line48' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":48
 *             savebinsPtr[i] = missingHighValue
 *             continue
 *         ibin=<code><</code>int>fbin             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         countPtr[ibin]+=1
 *         savebinsPtr[i]=ibin
 */
    __pyx_v_ibin = ((int)__pyx_v_fbin);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49:         countPtr[ibin]+=1</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":49
 *             continue
 *         ibin=<code><</code>int>fbin
 *         countPtr[ibin]+=1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         savebinsPtr[i]=ibin
 * 
 */
    __pyx_t_16 = __pyx_v_ibin;
    (__pyx_v_countPtr[__pyx_t_16]) = ((__pyx_v_countPtr[__pyx_t_16]) + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50:         savebinsPtr[i]=ibin</pre>
<pre id='line50' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":50
 *         ibin=<code><</code>int>fbin
 *         countPtr[ibin]+=1
 *         savebinsPtr[i]=ibin             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i in range(numbins + 1):
 */
    (__pyx_v_savebinsPtr[__pyx_v_i]) = __pyx_v_ibin;
    __pyx_L3_continue:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51: </pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52:     for i in range(numbins + 1):</pre>
<pre id='line52' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":52
 *         savebinsPtr[i]=ibin
 * 
 *     for i in range(numbins + 1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       edgePtr[i] = mindata + (i*binsize)
 *     for i in range(numbins):
 */
  __pyx_t_17 = (__pyx_v_numbins + 1);
  for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_17; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:       edgePtr[i] = mindata + (i*binsize)</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":53
 * 
 *     for i in range(numbins + 1):
 *       edgePtr[i] = mindata + (i*binsize)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i in range(numbins):
 *       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.
 */
    (__pyx_v_edgePtr[__pyx_v_i]) = (__pyx_v_mindata + (__pyx_v_i * __pyx_v_binsize));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54:     for i in range(numbins):</pre>
<pre id='line54' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":54
 *     for i in range(numbins + 1):
 *       edgePtr[i] = mindata + (i*binsize)
 *     for i in range(numbins):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.
 *     retval={}
 */
  __pyx_t_13 = __pyx_v_numbins;
  for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_13; __pyx_t_16+=1) {
    __pyx_v_i = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":55
 *       edgePtr[i] = mindata + (i*binsize)
 *     for i in range(numbins):
 *       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval={}
 *     retval["missingLowValue"] = missingLowValue
 */
    (__pyx_v_centerPtr[__pyx_v_i]) = (((__pyx_v_edgePtr[__pyx_v_i]) + (__pyx_v_edgePtr[(__pyx_v_i + 1)])) / 2.);
  }
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line56")'> 56:     retval={}</pre>
<pre id='line56' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":56
 *     for i in range(numbins):
 *       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.
 *     retval={}             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["missingLowValue"] = missingLowValue
 *     retval["missingHighValue"] = missingHighValue
 */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_v_retval = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line57")'> 57:     retval["missingLowValue"] = missingLowValue</pre>
<pre id='line57' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":57
 *       centerPtr[i] = (edgePtr[i] + edgePtr[i+1])/2.
 *     retval={}
 *     retval["missingLowValue"] = missingLowValue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["missingHighValue"] = missingHighValue
 *     retval["numBins"] = numbins
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_missingLowValue);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__missingLowValue), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line58")'> 58:     retval["missingHighValue"] = missingHighValue</pre>
<pre id='line58' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":58
 *     retval={}
 *     retval["missingLowValue"] = missingLowValue
 *     retval["missingHighValue"] = missingHighValue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["numBins"] = numbins
 *     retval["edges"] = binedges
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_missingHighValue);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__missingHighValue), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line59")'> 59:     retval["numBins"] = numbins</pre>
<pre id='line59' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":59
 *     retval["missingLowValue"] = missingLowValue
 *     retval["missingHighValue"] = missingHighValue
 *     retval["numBins"] = numbins             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["edges"] = binedges
 *     retval["centers"] = bincenters
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numbins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__numBins), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line60")'> 60:     retval["edges"] = binedges</pre>
<pre id='line60' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":60
 *     retval["missingHighValue"] = missingHighValue
 *     retval["numBins"] = numbins
 *     retval["edges"] = binedges             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["centers"] = bincenters
 *     retval["counts"] = outcounts
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__edges), ((PyObject *)__pyx_v_binedges)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line61")'> 61:     retval["centers"] = bincenters</pre>
<pre id='line61' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":61
 *     retval["numBins"] = numbins
 *     retval["edges"] = binedges
 *     retval["centers"] = bincenters             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["counts"] = outcounts
 *     retval["lowcounts"] = lowcount
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__centers), ((PyObject *)__pyx_v_bincenters)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line62")'> 62:     retval["counts"] = outcounts</pre>
<pre id='line62' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":62
 *     retval["edges"] = binedges
 *     retval["centers"] = bincenters
 *     retval["counts"] = outcounts             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["lowcounts"] = lowcount
 *     retval["highcounts"] = highcount
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_v_outcounts)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line63")'> 63:     retval["lowcounts"] = lowcount</pre>
<pre id='line63' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":63
 *     retval["centers"] = bincenters
 *     retval["counts"] = outcounts
 *     retval["lowcounts"] = lowcount             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["highcounts"] = highcount
 *     retval["fullbins"] = savebins
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_lowcount);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__lowcounts), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line64")'> 64:     retval["highcounts"] = highcount</pre>
<pre id='line64' class='code' style='background-color: #FFFF79'>
  /* "hist2d\fasthist.pyx":64
 *     retval["counts"] = outcounts
 *     retval["lowcounts"] = lowcount
 *     retval["highcounts"] = highcount             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["fullbins"] = savebins
 *     return retval
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_highcount);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__highcounts), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line65")'> 65:     retval["fullbins"] = savebins</pre>
<pre id='line65' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":65
 *     retval["lowcounts"] = lowcount
 *     retval["highcounts"] = highcount
 *     retval["fullbins"] = savebins             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return retval
 * 
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__fullbins), ((PyObject *)__pyx_v_savebins)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line66")'> 66:     return retval</pre>
<pre id='line66' class='code' style='background-color: #FFFF14'>
  /* "hist2d\fasthist.pyx":66
 *     retval["highcounts"] = highcount
 *     retval["fullbins"] = savebins
 *     return retval             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_retval));
  __pyx_r = ((PyObject *)__pyx_v_retval);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_bincenters.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_binedges.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVec.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_outcounts.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_savebins.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.fullhist", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_bincenters.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_binedges.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVec.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_outcounts.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_savebins.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dataVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_outcounts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bincenters);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_binedges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_savebins);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_retval);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dataVecPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6hist2d_8fasthist_5hist2D(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6hist2d_8fasthist_4hist2D[] = "hist2D(xBinPy, yBinPy, int numXbins, int numYbins)\n\n      xBinArray is a vector of bin indices, each pixel gets a bin number\n      yBinArray is a vector of bin indices, each pixel gets a bin number\n      numXbins is the total number of bin indices for x\n      numYbins is the total number of bin indices for y\n      converageMap is a 2-d histogram with the number of points\n      in each 2d bin\n    ";
static PyMethodDef __pyx_mdef_6hist2d_8fasthist_5hist2D = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("hist2D"), (PyCFunction)__pyx_pw_6hist2d_8fasthist_5hist2D, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_6hist2d_8fasthist_4hist2D)};
static PyObject *__pyx_pw_6hist2d_8fasthist_5hist2D(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_xBinPy = 0;
  PyObject *__pyx_v_yBinPy = 0;
  int __pyx_v_numXbins;
  int __pyx_v_numYbins;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("hist2D (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__xBinPy,&__pyx_n_s__yBinPy,&__pyx_n_s__numXbins,&__pyx_n_s__numYbins,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__xBinPy)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__yBinPy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hist2D", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__numXbins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hist2D", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__numYbins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hist2D", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hist2D") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_xBinPy = values[0];
    __pyx_v_yBinPy = values[1];
    __pyx_v_numXbins = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_numXbins == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_numYbins = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_numYbins == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hist2D", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.hist2D", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6hist2d_8fasthist_4hist2D(__pyx_self, __pyx_v_xBinPy, __pyx_v_yBinPy, __pyx_v_numXbins, __pyx_v_numYbins);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67: </pre>
<pre id='line67' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68: </pre>
<pre id='line68' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line69")'> 69: def hist2D(object xBinPy,object yBinPy,int numXbins, int numYbins):</pre>
<pre id='line69' class='code' style='background-color: #FFFF5b'>
/* "hist2d\fasthist.pyx":69
 * 
 * 
 * def hist2D(object xBinPy,object yBinPy,int numXbins, int numYbins):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *       xBinArray is a vector of bin indices, each pixel gets a bin number
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_4hist2D(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_xBinPy, PyObject *__pyx_v_yBinPy, int __pyx_v_numXbins, int __pyx_v_numYbins) {
  PyArrayObject *__pyx_v_xBinArray = 0;
  PyArrayObject *__pyx_v_yBinArray = 0;
  Py_ssize_t *__pyx_v_xdataPtr;
  Py_ssize_t *__pyx_v_ydataPtr;
  __pyx_t_5numpy_int64_t __pyx_v_numXDataPoints;
  __pyx_t_5numpy_int64_t __pyx_v_numYDataPoints;
  int __pyx_v_numBins2D;
  PyObject *__pyx_v_binVecs = NULL;
  int __pyx_v_i;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_index;
  PyArrayObject *__pyx_v_coverageMap = 0;
  Py_ssize_t *__pyx_v_coveragePtr;
  PyObject *__pyx_v_arrayList = NULL;
  PyObject *__pyx_v_retval = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_coverageMap;
  __Pyx_Buffer __pyx_pybuffer_coverageMap;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xBinArray;
  __Pyx_Buffer __pyx_pybuffer_xBinArray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_yBinArray;
  __Pyx_Buffer __pyx_pybuffer_yBinArray;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("hist2D", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xBinPy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yBinPy);
  __pyx_pybuffer_xBinArray.pybuffer.buf = NULL;
  __pyx_pybuffer_xBinArray.refcount = 0;
  __pyx_pybuffernd_xBinArray.data = NULL;
  __pyx_pybuffernd_xBinArray.rcbuffer = &__pyx_pybuffer_xBinArray;
  __pyx_pybuffer_yBinArray.pybuffer.buf = NULL;
  __pyx_pybuffer_yBinArray.refcount = 0;
  __pyx_pybuffernd_yBinArray.data = NULL;
  __pyx_pybuffernd_yBinArray.rcbuffer = &__pyx_pybuffer_yBinArray;
  __pyx_pybuffer_coverageMap.pybuffer.buf = NULL;
  __pyx_pybuffer_coverageMap.refcount = 0;
  __pyx_pybuffernd_coverageMap.data = NULL;
  __pyx_pybuffernd_coverageMap.rcbuffer = &__pyx_pybuffer_coverageMap;

  /* "hist2d\fasthist.pyx":69
 * 
 * 
 * def hist2D(object xBinPy,object yBinPy,int numXbins, int numYbins):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *       xBinArray is a vector of bin indices, each pixel gets a bin number
 */
  __pyx_k_tuple_27 = <span class='py_c_api'>PyTuple_Pack</span>(21, ((PyObject *)__pyx_n_s__xBinPy), ((PyObject *)__pyx_n_s__yBinPy), ((PyObject *)__pyx_n_s__numXbins), ((PyObject *)__pyx_n_s__numYbins), ((PyObject *)__pyx_n_s__xBinArray), ((PyObject *)__pyx_n_s__yBinArray), ((PyObject *)__pyx_n_s__xdataPtr), ((PyObject *)__pyx_n_s__ydataPtr), ((PyObject *)__pyx_n_s__numXDataPoints), ((PyObject *)__pyx_n_s__numYDataPoints), ((PyObject *)__pyx_n_s__numBins2D), ((PyObject *)__pyx_n_s__binVecs), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__index), ((PyObject *)__pyx_n_s__coverageMap), ((PyObject *)__pyx_n_s__coveragePtr), ((PyObject *)__pyx_n_s__numPoints), ((PyObject *)__pyx_n_s__arrayList), ((PyObject *)__pyx_n_s__retval));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_27);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_27));

  /* "hist2d\fasthist.pyx":69
 * 
 * 
 * def hist2D(object xBinPy,object yBinPy,int numXbins, int numYbins):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *       xBinArray is a vector of bin indices, each pixel gets a bin number
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_5hist2D, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__hist2D, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_28 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 21, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_23, __pyx_n_s__hist2D, 69, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:     """</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71:       xBinArray is a vector of bin indices, each pixel gets a bin number</pre>
<pre id='line71' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line72")'> 72:       yBinArray is a vector of bin indices, each pixel gets a bin number</pre>
<pre id='line72' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73:       numXbins is the total number of bin indices for x</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74:       numYbins is the total number of bin indices for y</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75:       converageMap is a 2-d histogram with the number of points</pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76:       in each 2d bin</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:     """</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line78")'> 78:     xBinPy=np.ascontiguousarray(xBinPy,dtype=np.int64)</pre>
<pre id='line78' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":78
 *       in each 2d bin
 *     """
 *     xBinPy=np.ascontiguousarray(xBinPy,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] xBinArray = xBinPy
 *     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xBinPy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_xBinPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_xBinPy);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_xBinPy);
  __pyx_v_xBinPy = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line79")'> 79:     cdef np.ndarray[np.int64_t,ndim=1] xBinArray = xBinPy</pre>
<pre id='line79' class='code' style='background-color: #FFFF9f'>
  /* "hist2d\fasthist.pyx":79
 *     """
 *     xBinPy=np.ascontiguousarray(xBinPy,dtype=np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=1] xBinArray = xBinPy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy
 */
  if (!(likely(((__pyx_v_xBinPy) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_xBinPy, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_v_xBinPy);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_xBinArray.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_xBinArray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_xBinArray.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_xBinArray.diminfo[0].strides = __pyx_pybuffernd_xBinArray.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_xBinArray.diminfo[0].shape = __pyx_pybuffernd_xBinArray.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xBinPy);
  __pyx_v_xBinArray = ((PyArrayObject *)__pyx_v_xBinPy);
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line80")'> 80:     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)</pre>
<pre id='line80' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":80
 *     xBinPy=np.ascontiguousarray(xBinPy,dtype=np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=1] xBinArray = xBinPy
 *     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy
 *     cdef Py_ssize_t* xdataPtr=<code><</code>Py_ssize_t*>xBinArray.data
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yBinPy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_yBinPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_yBinPy);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_yBinPy);
  __pyx_v_yBinPy = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line81")'> 81:     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy</pre>
<pre id='line81' class='code' style='background-color: #FFFF9f'>
  /* "hist2d\fasthist.pyx":81
 *     cdef np.ndarray[np.int64_t,ndim=1] xBinArray = xBinPy
 *     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Py_ssize_t* xdataPtr=<code><</code>Py_ssize_t*>xBinArray.data
 *     cdef Py_ssize_t* ydataPtr=<code><</code>Py_ssize_t*>yBinArray.data
 */
  if (!(likely(((__pyx_v_yBinPy) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_yBinPy, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_v_yBinPy);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_yBinArray.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_yBinArray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_yBinArray.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_yBinArray.diminfo[0].strides = __pyx_pybuffernd_yBinArray.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_yBinArray.diminfo[0].shape = __pyx_pybuffernd_yBinArray.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yBinPy);
  __pyx_v_yBinArray = ((PyArrayObject *)__pyx_v_yBinPy);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82:     cdef Py_ssize_t* xdataPtr=&lt;Py_ssize_t*&gt;xBinArray.data</pre>
<pre id='line82' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":82
 *     yBinPy=np.ascontiguousarray(yBinPy,dtype=np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy
 *     cdef Py_ssize_t* xdataPtr=<code><</code>Py_ssize_t*>xBinArray.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Py_ssize_t* ydataPtr=<code><</code>Py_ssize_t*>yBinArray.data
 *     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]
 */
  __pyx_v_xdataPtr = ((Py_ssize_t *)__pyx_v_xBinArray->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:     cdef Py_ssize_t* ydataPtr=&lt;Py_ssize_t*&gt;yBinArray.data</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":83
 *     cdef np.ndarray[np.int64_t,ndim=1] yBinArray = yBinPy
 *     cdef Py_ssize_t* xdataPtr=<code><</code>Py_ssize_t*>xBinArray.data
 *     cdef Py_ssize_t* ydataPtr=<code><</code>Py_ssize_t*>yBinArray.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]
 */
  __pyx_v_ydataPtr = ((Py_ssize_t *)__pyx_v_yBinArray->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84:     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]</pre>
<pre id='line84' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":84
 *     cdef Py_ssize_t* xdataPtr=<code><</code>Py_ssize_t*>xBinArray.data
 *     cdef Py_ssize_t* ydataPtr=<code><</code>Py_ssize_t*>yBinArray.data
 *     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]
 *     if numXDataPoints != numYDataPoints:
 */
  __pyx_v_numXDataPoints = (__pyx_v_xBinArray->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:     cdef np.int64_t numYDataPoints=yBinArray.shape[0]</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":85
 *     cdef Py_ssize_t* ydataPtr=<code><</code>Py_ssize_t*>yBinArray.data
 *     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if numXDataPoints != numYDataPoints:
 *         raise ValueError('need x and y fields of equal size')
 */
  __pyx_v_numYDataPoints = (__pyx_v_yBinArray->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:     if numXDataPoints != numYDataPoints:</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":86
 *     cdef np.int64_t  numXDataPoints=xBinArray.shape[0]
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]
 *     if numXDataPoints != numYDataPoints:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise ValueError('need x and y fields of equal size')
 *     cdef int numBins2D=numXbins*numYbins
 */
  __pyx_t_8 = ((__pyx_v_numXDataPoints != __pyx_v_numYDataPoints) != 0);
  if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line87")'> 87:         raise ValueError('need x and y fields of equal size')</pre>
<pre id='line87' class='code' style='background-color: #FFFF6e'>
    /* "hist2d\fasthist.pyx":87
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]
 *     if numXDataPoints != numYDataPoints:
 *         raise ValueError('need x and y fields of equal size')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int numBins2D=numXbins*numYbins
 *     binVecs=[]
 */
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_ValueError, ((PyObject *)__pyx_k_tuple_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "hist2d\fasthist.pyx":87
 *     cdef np.int64_t numYDataPoints=yBinArray.shape[0]
 *     if numXDataPoints != numYDataPoints:
 *         raise ValueError('need x and y fields of equal size')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int numBins2D=numXbins*numYbins
 *     binVecs=[]
 */
  __pyx_k_tuple_4 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_3));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_4));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:     cdef int numBins2D=numXbins*numYbins</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":88
 *     if numXDataPoints != numYDataPoints:
 *         raise ValueError('need x and y fields of equal size')
 *     cdef int numBins2D=numXbins*numYbins             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     binVecs=[]
 *     cdef int i
 */
  __pyx_v_numBins2D = (__pyx_v_numXbins * __pyx_v_numYbins);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line89")'> 89:     binVecs=[]</pre>
<pre id='line89' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":89
 *         raise ValueError('need x and y fields of equal size')
 *     cdef int numBins2D=numXbins*numYbins
 *     binVecs=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     for i in range(numBins2D):
 */
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_v_binVecs = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:     cdef int i</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:     for i in range(numBins2D):</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":91
 *     binVecs=[]
 *     cdef int i
 *     for i in range(numBins2D):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       binVecs.append([])
 *     cdef int x = 0, y=0, index=0
 */
  __pyx_t_9 = __pyx_v_numBins2D;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line92")'> 92:       binVecs.append([])</pre>
<pre id='line92' class='code' style='background-color: #FFFF79'>
    /* "hist2d\fasthist.pyx":92
 *     cdef int i
 *     for i in range(numBins2D):
 *       binVecs.append([])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int x = 0, y=0, index=0
 *     #drop the indexes into a nensted list
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_11 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_binVecs, ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:     cdef int x = 0, y=0, index=0</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":93
 *     for i in range(numBins2D):
 *       binVecs.append([])
 *     cdef int x = 0, y=0, index=0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #drop the indexes into a nensted list
 *     for i in range(numXDataPoints):
 */
  __pyx_v_x = 0;
  __pyx_v_y = 0;
  __pyx_v_index = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94:     #drop the indexes into a nensted list</pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:     for i in range(numXDataPoints):</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":95
 *     cdef int x = 0, y=0, index=0
 *     #drop the indexes into a nensted list
 *     for i in range(numXDataPoints):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       if (xdataPtr[i] > -1) & (ydataPtr[i] > -1):
 *         x = xdataPtr[i]
 */
  __pyx_t_12 = __pyx_v_numXDataPoints;
  for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_12; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:       if (xdataPtr[i] &gt; -1) &amp; (ydataPtr[i] &gt; -1):</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":96
 *     #drop the indexes into a nensted list
 *     for i in range(numXDataPoints):
 *       if (xdataPtr[i] > -1) & (ydataPtr[i] > -1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         x = xdataPtr[i]
 *         y = ydataPtr[i]
 */
    __pyx_t_8 = ((((__pyx_v_xdataPtr[__pyx_v_i]) > -1) & ((__pyx_v_ydataPtr[__pyx_v_i]) > -1)) != 0);
    if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:         x = xdataPtr[i]</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":97
 *     for i in range(numXDataPoints):
 *       if (xdataPtr[i] > -1) & (ydataPtr[i] > -1):
 *         x = xdataPtr[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         y = ydataPtr[i]
 *         #2D row major, numYbins is number of columns, numXbins is number of rows
 */
      __pyx_v_x = (__pyx_v_xdataPtr[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:         y = ydataPtr[i]</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":98
 *       if (xdataPtr[i] > -1) & (ydataPtr[i] > -1):
 *         x = xdataPtr[i]
 *         y = ydataPtr[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #2D row major, numYbins is number of columns, numXbins is number of rows
 *         #if numXbins=10 and numYbins=5, then an (x,y) of (5,3) gives
 */
      __pyx_v_y = (__pyx_v_ydataPtr[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:         #2D row major, numYbins is number of columns, numXbins is number of rows</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100:         #if numXbins=10 and numYbins=5, then an (x,y) of (5,3) gives</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101:         #an index of 28</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102:         index = numYbins*x + y</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'>
      /* "hist2d\fasthist.pyx":102
 *         #if numXbins=10 and numYbins=5, then an (x,y) of (5,3) gives
 *         #an index of 28
 *         index = numYbins*x + y             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         binVecs[index].append(i)
 *     #return an 2D numpy array with the number of points in each cell
 */
      __pyx_v_index = ((__pyx_v_numYbins * __pyx_v_x) + __pyx_v_y);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line103")'> 103:         binVecs[index].append(i)</pre>
<pre id='line103' class='code' style='background-color: #FFFF66'>
      /* "hist2d\fasthist.pyx":103
 *         #an index of 28
 *         index = numYbins*x + y
 *         binVecs[index].append(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #return an 2D numpy array with the number of points in each cell
 *     cdef np.ndarray[np.int64_t,ndim=2] coverageMap = np.zeros([numXbins,numYbins],dtype=np.int64)
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_binVecs), __pyx_v_index, sizeof(int), PyInt_FromLong, 1, 1, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:     #return an 2D numpy array with the number of points in each cell</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line105")'> 105:     cdef np.ndarray[np.int64_t,ndim=2] coverageMap = np.zeros([numXbins,numYbins],dtype=np.int64)</pre>
<pre id='line105' class='code' style='background-color: #FFFF22'>
  /* "hist2d\fasthist.pyx":105
 *         binVecs[index].append(i)
 *     #return an 2D numpy array with the number of points in each cell
 *     cdef np.ndarray[np.int64_t,ndim=2] coverageMap = np.zeros([numXbins,numYbins],dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Py_ssize_t* coveragePtr = <code><</code>Py_ssize_t*> coverageMap.data
 *     cdef int numPoints
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numXbins);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numYbins);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_coverageMap.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_coverageMap = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_coverageMap.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_coverageMap.diminfo[0].strides = __pyx_pybuffernd_coverageMap.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coverageMap.diminfo[0].shape = __pyx_pybuffernd_coverageMap.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coverageMap.diminfo[1].strides = __pyx_pybuffernd_coverageMap.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coverageMap.diminfo[1].shape = __pyx_pybuffernd_coverageMap.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_coverageMap = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106:     cdef Py_ssize_t* coveragePtr = &lt;Py_ssize_t*&gt; coverageMap.data</pre>
<pre id='line106' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":106
 *     #return an 2D numpy array with the number of points in each cell
 *     cdef np.ndarray[np.int64_t,ndim=2] coverageMap = np.zeros([numXbins,numYbins],dtype=np.int64)
 *     cdef Py_ssize_t* coveragePtr = <code><</code>Py_ssize_t*> coverageMap.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int numPoints
 *     #convert list of list to list of np.arrays
 */
  __pyx_v_coveragePtr = ((Py_ssize_t *)__pyx_v_coverageMap->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     cdef int numPoints</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:     #convert list of list to list of np.arrays</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line109")'> 109:     arrayList=[]</pre>
<pre id='line109' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":109
 *     cdef int numPoints
 *     #convert list of list to list of np.arrays
 *     arrayList=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i in range(numBins2D):
 *       arrayList.append(np.array(binVecs[i],dtype=np.int64))
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_arrayList = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110:     for i in range(numBins2D):</pre>
<pre id='line110' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":110
 *     #convert list of list to list of np.arrays
 *     arrayList=[]
 *     for i in range(numBins2D):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       arrayList.append(np.array(binVecs[i],dtype=np.int64))
 *       #number of pixels in each bin
 */
  __pyx_t_9 = __pyx_v_numBins2D;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line111")'> 111:       arrayList.append(np.array(binVecs[i],dtype=np.int64))</pre>
<pre id='line111' class='code' style='background-color: #FFFF2b'>
    /* "hist2d\fasthist.pyx":111
 *     arrayList=[]
 *     for i in range(numBins2D):
 *       arrayList.append(np.array(binVecs[i],dtype=np.int64))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       #number of pixels in each bin
 *       coveragePtr[i]=len(binVecs[i])
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_binVecs), __pyx_v_i, sizeof(int), PyInt_FromLong, 1, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_11 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_arrayList, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112:       #number of pixels in each bin</pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line113")'> 113:       coveragePtr[i]=len(binVecs[i])</pre>
<pre id='line113' class='code' style='background-color: #FFFF8d'>
    /* "hist2d\fasthist.pyx":113
 *       arrayList.append(np.array(binVecs[i],dtype=np.int64))
 *       #number of pixels in each bin
 *       coveragePtr[i]=len(binVecs[i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval={}
 *     retval["coverage"]= coverageMap
 */
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_binVecs), __pyx_v_i, sizeof(int), PyInt_FromLong, 1, 1, 1);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    (__pyx_v_coveragePtr[__pyx_v_i]) = __pyx_t_14;
  }
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line114")'> 114:     retval={}</pre>
<pre id='line114' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":114
 *       #number of pixels in each bin
 *       coveragePtr[i]=len(binVecs[i])
 *     retval={}             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["coverage"]= coverageMap
 *     retval["indexList"]= arrayList
 */
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  __pyx_v_retval = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line115")'> 115:     retval["coverage"]= coverageMap</pre>
<pre id='line115' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":115
 *       coveragePtr[i]=len(binVecs[i])
 *     retval={}
 *     retval["coverage"]= coverageMap             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     retval["indexList"]= arrayList
 *     return retval
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__coverage), ((PyObject *)__pyx_v_coverageMap)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line116")'> 116:     retval["indexList"]= arrayList</pre>
<pre id='line116' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":116
 *     retval={}
 *     retval["coverage"]= coverageMap
 *     retval["indexList"]= arrayList             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return retval
 * 
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_retval), ((PyObject *)__pyx_n_s__indexList), ((PyObject *)__pyx_v_arrayList)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line117")'> 117:     return retval</pre>
<pre id='line117' class='code' style='background-color: #FFFF20'>
  /* "hist2d\fasthist.pyx":117
 *     retval["coverage"]= coverageMap
 *     retval["indexList"]= arrayList
 *     return retval             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_retval));
  __pyx_r = ((PyObject *)__pyx_v_retval);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_coverageMap.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_xBinArray.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_yBinArray.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.hist2D", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_coverageMap.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_xBinArray.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_yBinArray.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_xBinArray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_yBinArray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binVecs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_coverageMap);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arrayList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_retval);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xBinPy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yBinPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6hist2d_8fasthist_7takeValues(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6hist2d_8fasthist_6takeValues[] = "takeValues(dataVectorPy, indexList)\n\n    do a take of the indices in indexList to populate a new list of data\n    filled with dataVector values.  See findMean and findMedian\n    below for usage\n    ";
static PyMethodDef __pyx_mdef_6hist2d_8fasthist_7takeValues = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("takeValues"), (PyCFunction)__pyx_pw_6hist2d_8fasthist_7takeValues, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_6hist2d_8fasthist_6takeValues)};
static PyObject *__pyx_pw_6hist2d_8fasthist_7takeValues(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dataVectorPy = 0;
  PyObject *__pyx_v_indexList = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("takeValues (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__dataVectorPy,&__pyx_n_s__indexList,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dataVectorPy)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__indexList)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("takeValues", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "takeValues") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_dataVectorPy = values[0];
    __pyx_v_indexList = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("takeValues", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.takeValues", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6hist2d_8fasthist_6takeValues(__pyx_self, __pyx_v_dataVectorPy, __pyx_v_indexList);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118: </pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119: </pre>
<pre id='line119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line120")'> 120: def takeValues(object dataVectorPy, object indexList):</pre>
<pre id='line120' class='code' style='background-color: #FFFF5e'>
/* "hist2d\fasthist.pyx":120
 * 
 * 
 * def takeValues(object dataVectorPy, object indexList):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_6takeValues(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dataVectorPy, PyObject *__pyx_v_indexList) {
  PyArrayObject *__pyx_v_dataVector = 0;
  PyObject *__pyx_v_outList = NULL;
  float *__pyx_v_dataPtr;
  PyArrayObject *__pyx_v_indexVec = 0;
  PyArrayObject *__pyx_v_takeVec = 0;
  int __pyx_v_numBins2D;
  int __pyx_v_numDataPoints;
  int __pyx_v_i;
  int __pyx_v_j;
  float *__pyx_v_takePtr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dataVector;
  __Pyx_Buffer __pyx_pybuffer_dataVector;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indexVec;
  __Pyx_Buffer __pyx_pybuffer_indexVec;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_takeVec;
  __Pyx_Buffer __pyx_pybuffer_takeVec;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("takeValues", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  __pyx_pybuffer_dataVector.pybuffer.buf = NULL;
  __pyx_pybuffer_dataVector.refcount = 0;
  __pyx_pybuffernd_dataVector.data = NULL;
  __pyx_pybuffernd_dataVector.rcbuffer = &__pyx_pybuffer_dataVector;
  __pyx_pybuffer_indexVec.pybuffer.buf = NULL;
  __pyx_pybuffer_indexVec.refcount = 0;
  __pyx_pybuffernd_indexVec.data = NULL;
  __pyx_pybuffernd_indexVec.rcbuffer = &__pyx_pybuffer_indexVec;
  __pyx_pybuffer_takeVec.pybuffer.buf = NULL;
  __pyx_pybuffer_takeVec.refcount = 0;
  __pyx_pybuffernd_takeVec.data = NULL;
  __pyx_pybuffernd_takeVec.rcbuffer = &__pyx_pybuffer_takeVec;

  /* "hist2d\fasthist.pyx":120
 * 
 * 
 * def takeValues(object dataVectorPy, object indexList):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */
  __pyx_k_tuple_29 = <span class='py_c_api'>PyTuple_Pack</span>(12, ((PyObject *)__pyx_n_s__dataVectorPy), ((PyObject *)__pyx_n_s__indexList), ((PyObject *)__pyx_n_s__dataVector), ((PyObject *)__pyx_n_s__outList), ((PyObject *)__pyx_n_s__dataPtr), ((PyObject *)__pyx_n_s__indexVec), ((PyObject *)__pyx_n_s__takeVec), ((PyObject *)__pyx_n_s__numBins2D), ((PyObject *)__pyx_n_s__numDataPoints), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__j), ((PyObject *)__pyx_n_s__takePtr));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_29);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_29));

  /* "hist2d\fasthist.pyx":120
 * 
 * 
 * def takeValues(object dataVectorPy, object indexList):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_7takeValues, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__takeValues, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_30 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 12, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_23, __pyx_n_s__takeValues, 120, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121:     """</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:     do a take of the indices in indexList to populate a new list of data</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:     filled with dataVector values.  See findMean and findMedian</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124:     below for usage</pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line125")'> 125:     """</pre>
<pre id='line125' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line126")'> 126:     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)</pre>
<pre id='line126' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":126
 *     below for usage
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dataVectorPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_dataVectorPy);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVectorPy = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line127")'> 127:     dataVectorPy=dataVectorPy.reshape(-1)</pre>
<pre id='line127' class='code' style='background-color: #FFFF5e'>
  /* "hist2d\fasthist.pyx":127
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     outList=[]
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_dataVectorPy, __pyx_n_s__reshape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVectorPy = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "hist2d\fasthist.pyx":127
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     outList=[]
 */
  __pyx_k_tuple_5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_5));
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line128")'> 128:     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy</pre>
<pre id='line128' class='code' style='background-color: #FFFF9f'>
  /* "hist2d\fasthist.pyx":128
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outList=[]
 *     cdef float* dataPtr=<code><</code>float*>dataVector.data
 */
  if (!(likely(((__pyx_v_dataVectorPy) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_dataVectorPy, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_v_dataVectorPy);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_dataVector = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_dataVector.diminfo[0].strides = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dataVector.diminfo[0].shape = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVector = ((PyArrayObject *)__pyx_v_dataVectorPy);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line129")'> 129:     outList=[]</pre>
<pre id='line129' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":129
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     outList=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float* dataPtr=<code><</code>float*>dataVector.data
 *     cdef np.ndarray[np.int64_t,ndim=1] indexVec
 */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_v_outList = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:     cdef float* dataPtr=&lt;float*&gt;dataVector.data</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":130
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     outList=[]
 *     cdef float* dataPtr=<code><</code>float*>dataVector.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] indexVec
 *     cdef np.ndarray[np.float32_t,ndim=1] takeVec
 */
  __pyx_v_dataPtr = ((float *)__pyx_v_dataVector->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131:     cdef np.ndarray[np.int64_t,ndim=1] indexVec</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132:     cdef np.ndarray[np.float32_t,ndim=1] takeVec</pre>
<pre id='line132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line133")'> 133:     cdef int numBins2D=len(indexList)</pre>
<pre id='line133' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":133
 *     cdef np.ndarray[np.int64_t,ndim=1] indexVec
 *     cdef np.ndarray[np.float32_t,ndim=1] takeVec
 *     cdef int numBins2D=len(indexList)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int numDataPoints,i,j
 *     cdef float* takePtr
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_indexList);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_numBins2D = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:     cdef int numDataPoints,i,j</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135:     cdef float* takePtr</pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:     for i in range(numBins2D):</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":136
 *     cdef int numDataPoints,i,j
 *     cdef float* takePtr
 *     for i in range(numBins2D):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         indexVec=indexList[i]
 *         numDataPoints=len(indexVec)
 */
  __pyx_t_8 = __pyx_v_numBins2D;
  for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line137")'> 137:         indexVec=indexList[i]</pre>
<pre id='line137' class='code' style='background-color: #FFFF4d'>
    /* "hist2d\fasthist.pyx":137
 *     cdef float* takePtr
 *     for i in range(numBins2D):
 *         indexVec=indexList[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         numDataPoints=len(indexVec)
 *         takeVec=np.zeros([numDataPoints,],dtype=np.float32)
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_indexList, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = ((PyArrayObject *)__pyx_t_3);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_indexVec.rcbuffer->pybuffer);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_indexVec.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_11 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_indexVec.rcbuffer->pybuffer, (PyObject*)__pyx_v_indexVec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
        }
      }
      __pyx_pybuffernd_indexVec.diminfo[0].strides = __pyx_pybuffernd_indexVec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_indexVec.diminfo[0].shape = __pyx_pybuffernd_indexVec.rcbuffer->pybuffer.shape[0];
      if (unlikely(__pyx_t_11 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_indexVec));
    __pyx_v_indexVec = ((PyArrayObject *)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line138")'> 138:         numDataPoints=len(indexVec)</pre>
<pre id='line138' class='code' style='background-color: #FFFFaa'>
    /* "hist2d\fasthist.pyx":138
 *     for i in range(numBins2D):
 *         indexVec=indexList[i]
 *         numDataPoints=len(indexVec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         takeVec=np.zeros([numDataPoints,],dtype=np.float32)
 *         takePtr=<code><</code>float*>takeVec.data
 */
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_indexVec));<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_numDataPoints = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line139")'> 139:         takeVec=np.zeros([numDataPoints,],dtype=np.float32)</pre>
<pre id='line139' class='code' style='background-color: #FFFF1e'>
    /* "hist2d\fasthist.pyx":139
 *         indexVec=indexList[i]
 *         numDataPoints=len(indexVec)
 *         takeVec=np.zeros([numDataPoints,],dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         takePtr=<code><</code>float*>takeVec.data
 *         for j in range(numDataPoints):
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_numDataPoints);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_3), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_takeVec.rcbuffer->pybuffer);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_takeVec.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_11 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_14, &__pyx_t_13, &__pyx_t_12);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_takeVec.rcbuffer->pybuffer, (PyObject*)__pyx_v_takeVec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_12);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_14, __pyx_t_13, __pyx_t_12);
        }
      }
      __pyx_pybuffernd_takeVec.diminfo[0].strides = __pyx_pybuffernd_takeVec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_takeVec.diminfo[0].shape = __pyx_pybuffernd_takeVec.rcbuffer->pybuffer.shape[0];
      if (unlikely(__pyx_t_11 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_takeVec));
    __pyx_v_takeVec = ((PyArrayObject *)__pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:         takePtr=&lt;float*&gt;takeVec.data</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":140
 *         numDataPoints=len(indexVec)
 *         takeVec=np.zeros([numDataPoints,],dtype=np.float32)
 *         takePtr=<code><</code>float*>takeVec.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j in range(numDataPoints):
 *           takePtr[j]=dataPtr[indexVec[j]]
 */
    __pyx_v_takePtr = ((float *)__pyx_v_takeVec->data);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141:         for j in range(numDataPoints):</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'>
    /* "hist2d\fasthist.pyx":141
 *         takeVec=np.zeros([numDataPoints,],dtype=np.float32)
 *         takePtr=<code><</code>float*>takeVec.data
 *         for j in range(numDataPoints):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *           takePtr[j]=dataPtr[indexVec[j]]
 *         outList.append(takeVec)
 */
    __pyx_t_11 = __pyx_v_numDataPoints;
    for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_11; __pyx_t_16+=1) {
      __pyx_v_j = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line142")'> 142:           takePtr[j]=dataPtr[indexVec[j]]</pre>
<pre id='line142' class='code' style='background-color: #FFFFd4'>
      /* "hist2d\fasthist.pyx":142
 *         takePtr=<code><</code>float*>takeVec.data
 *         for j in range(numDataPoints):
 *           takePtr[j]=dataPtr[indexVec[j]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         outList.append(takeVec)
 *     return outList
 */
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_18 = -1;
      if (__pyx_t_17 <code><</code> 0) {
        __pyx_t_17 += __pyx_pybuffernd_indexVec.diminfo[0].shape;
        if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_18 = 0;
      } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_indexVec.diminfo[0].shape)) __pyx_t_18 = 0;
      if (unlikely(__pyx_t_18 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_18);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      (__pyx_v_takePtr[__pyx_v_j]) = (__pyx_v_dataPtr[(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_indexVec.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_indexVec.diminfo[0].strides))]);
    }
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line143")'> 143:         outList.append(takeVec)</pre>
<pre id='line143' class='code' style='background-color: #FFFFaa'>
    /* "hist2d\fasthist.pyx":143
 *         for j in range(numDataPoints):
 *           takePtr[j]=dataPtr[indexVec[j]]
 *         outList.append(takeVec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return outList
 * 
 */
    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_outList, ((PyObject *)__pyx_v_takeVec));<span class='error_goto'> if (unlikely(__pyx_t_19 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line144")'> 144:     return outList</pre>
<pre id='line144' class='code' style='background-color: #FFFF1e'>
  /* "hist2d\fasthist.pyx":144
 *           takePtr[j]=dataPtr[indexVec[j]]
 *         outList.append(takeVec)
 *     return outList             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def findMean(object dataVectorPy, object indexList,maskedValue= -9999.):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outList));
  __pyx_r = ((PyObject *)__pyx_v_outList);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_indexVec.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_takeVec.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.takeValues", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_indexVec.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_takeVec.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dataVector);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indexVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_takeVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dataVectorPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6hist2d_8fasthist_9findMean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6hist2d_8fasthist_8findMean[] = "findMean(dataVectorPy, indexList, maskedValue=-9999.0)\n\n    find the mean of binned variables\n    ";
static PyMethodDef __pyx_mdef_6hist2d_8fasthist_9findMean = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("findMean"), (PyCFunction)__pyx_pw_6hist2d_8fasthist_9findMean, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_6hist2d_8fasthist_8findMean)};
static PyObject *__pyx_pw_6hist2d_8fasthist_9findMean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dataVectorPy = 0;
  PyObject *__pyx_v_indexList = 0;
  PyObject *__pyx_v_maskedValue = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("findMean (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__dataVectorPy,&__pyx_n_s__indexList,&__pyx_n_s__maskedValue,0};
    PyObject* values[3] = {0,0,0};
    values[2] = __pyx_k_6;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dataVectorPy)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__indexList)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("findMean", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__maskedValue);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "findMean") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dataVectorPy = values[0];
    __pyx_v_indexList = values[1];
    __pyx_v_maskedValue = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("findMean", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.findMean", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6hist2d_8fasthist_8findMean(__pyx_self, __pyx_v_dataVectorPy, __pyx_v_indexList, __pyx_v_maskedValue);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145: </pre>
<pre id='line145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line146")'> 146: def findMean(object dataVectorPy, object indexList,maskedValue= -9999.):</pre>
<pre id='line146' class='code' style='background-color: #FFFF4f'>
/* "hist2d\fasthist.pyx":146
 *     return outList
 * 
 * def findMean(object dataVectorPy, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     find the mean of binned variables
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_8findMean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dataVectorPy, PyObject *__pyx_v_indexList, PyObject *__pyx_v_maskedValue) {
  PyArrayObject *__pyx_v_dataVector = 0;
  PyObject *__pyx_v_dataList = NULL;
  int __pyx_v_dataCount;
  int __pyx_v_i;
  PyObject *__pyx_v_outList = NULL;
  PyObject *__pyx_v_areaWeightedOutList = NULL;
  PyObject *__pyx_v_gridCounts = NULL;
  PyArrayObject *__pyx_v_theData = 0;
  PyObject *__pyx_v_outVec = NULL;
  PyObject *__pyx_v_outAreaWeightedVec = NULL;
  PyObject *__pyx_v_outArray = NULL;
  PyObject *__pyx_v_outAreaArray = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dataVector;
  __Pyx_Buffer __pyx_pybuffer_dataVector;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_theData;
  __Pyx_Buffer __pyx_pybuffer_theData;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("findMean", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  __pyx_pybuffer_dataVector.pybuffer.buf = NULL;
  __pyx_pybuffer_dataVector.refcount = 0;
  __pyx_pybuffernd_dataVector.data = NULL;
  __pyx_pybuffernd_dataVector.rcbuffer = &__pyx_pybuffer_dataVector;
  __pyx_pybuffer_theData.pybuffer.buf = NULL;
  __pyx_pybuffer_theData.refcount = 0;
  __pyx_pybuffernd_theData.data = NULL;
  __pyx_pybuffernd_theData.rcbuffer = &__pyx_pybuffer_theData;

  /* "hist2d\fasthist.pyx":146
 *     return outList
 * 
 * def findMean(object dataVectorPy, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     find the mean of binned variables
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(-9999.);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_6 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "hist2d\fasthist.pyx":146
 *     return outList
 * 
 * def findMean(object dataVectorPy, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     find the mean of binned variables
 */
  __pyx_k_tuple_31 = <span class='py_c_api'>PyTuple_Pack</span>(15, ((PyObject *)__pyx_n_s__dataVectorPy), ((PyObject *)__pyx_n_s__indexList), ((PyObject *)__pyx_n_s__maskedValue), ((PyObject *)__pyx_n_s__dataVector), ((PyObject *)__pyx_n_s__dataList), ((PyObject *)__pyx_n_s__dataCount), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__outList), ((PyObject *)__pyx_n_s__areaWeightedOutList), ((PyObject *)__pyx_n_s__gridCounts), ((PyObject *)__pyx_n_s__theData), ((PyObject *)__pyx_n_s__outVec), ((PyObject *)__pyx_n_s__outAreaWeightedVec), ((PyObject *)__pyx_n_s__outArray), ((PyObject *)__pyx_n_s__outAreaArray));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_31);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_31));
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_9findMean, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__findMean, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_32 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_23, __pyx_n_s__findMean, 146, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:     """</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:     find the mean of binned variables</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:     """</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line150")'> 150:     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)</pre>
<pre id='line150' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":150
 *     find the mean of binned variables
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dataVectorPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_dataVectorPy);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVectorPy = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line151")'> 151:     dataVectorPy=dataVectorPy.reshape(-1)</pre>
<pre id='line151' class='code' style='background-color: #FFFF5e'>
  /* "hist2d\fasthist.pyx":151
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     dataList=takeValues(dataVector,indexList)
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_dataVectorPy, __pyx_n_s__reshape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVectorPy = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "hist2d\fasthist.pyx":151
 *     """
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     dataList=takeValues(dataVector,indexList)
 */
  __pyx_k_tuple_7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_7));
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line152")'> 152:     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy</pre>
<pre id='line152' class='code' style='background-color: #FFFF9f'>
  /* "hist2d\fasthist.pyx":152
 *     dataVectorPy=np.ascontiguousarray(dataVectorPy,dtype=np.float32)
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dataList=takeValues(dataVector,indexList)
 *     cdef int dataCount=len(dataList)
 */
  if (!(likely(((__pyx_v_dataVectorPy) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_dataVectorPy, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_v_dataVectorPy);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_dataVector = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_dataVector.diminfo[0].strides = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dataVector.diminfo[0].shape = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dataVectorPy);
  __pyx_v_dataVector = ((PyArrayObject *)__pyx_v_dataVectorPy);
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line153")'> 153:     dataList=takeValues(dataVector,indexList)</pre>
<pre id='line153' class='code' style='background-color: #FFFF5b'>
  /* "hist2d\fasthist.pyx":153
 *     dataVectorPy=dataVectorPy.reshape(-1)
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     dataList=takeValues(dataVector,indexList)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int dataCount=len(dataList)
 *     cdef int i
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__takeValues);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_dataVector));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_dataVector));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_dataVector));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indexList);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_indexList);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_indexList);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_v_dataList = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line154")'> 154:     cdef int dataCount=len(dataList)</pre>
<pre id='line154' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":154
 *     cdef np.ndarray[np.float32_t,ndim=1] dataVector = dataVectorPy
 *     dataList=takeValues(dataVector,indexList)
 *     cdef int dataCount=len(dataList)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     outList=[]
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_dataList);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dataCount = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155:     cdef int i</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line156")'> 156:     outList=[]</pre>
<pre id='line156' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":156
 *     cdef int dataCount=len(dataList)
 *     cdef int i
 *     outList=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     areaWeightedOutList=[]
 *     gridCounts=[]
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_outList = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line157")'> 157:     areaWeightedOutList=[]</pre>
<pre id='line157' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":157
 *     cdef int i
 *     outList=[]
 *     areaWeightedOutList=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     gridCounts=[]
 *     cdef np.ndarray[float,ndim=1] theData
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_areaWeightedOutList = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line158")'> 158:     gridCounts=[]</pre>
<pre id='line158' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":158
 *     outList=[]
 *     areaWeightedOutList=[]
 *     gridCounts=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_gridCounts = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159:     cdef np.ndarray[float,ndim=1] theData</pre>
<pre id='line159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160:     for i in range(dataCount):</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":160
 *     gridCounts=[]
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         theData=dataList[i]
 *         if len(theData) > 0:
 */
  __pyx_t_8 = __pyx_v_dataCount;
  for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line161")'> 161:         theData=dataList[i]</pre>
<pre id='line161' class='code' style='background-color: #FFFF4d'>
    /* "hist2d\fasthist.pyx":161
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):
 *         theData=dataList[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if len(theData) > 0:
 *             outList.append(theData.mean())
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_dataList, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_11 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer, (PyObject*)__pyx_v_theData, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
        }
      }
      __pyx_pybuffernd_theData.diminfo[0].strides = __pyx_pybuffernd_theData.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theData.diminfo[0].shape = __pyx_pybuffernd_theData.rcbuffer->pybuffer.shape[0];
      if (unlikely(__pyx_t_11 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_theData));
    __pyx_v_theData = ((PyArrayObject *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line162")'> 162:         if len(theData) &gt; 0:</pre>
<pre id='line162' class='code' style='background-color: #FFFFaa'>
    /* "hist2d\fasthist.pyx":162
 *     for i in range(dataCount):
 *         theData=dataList[i]
 *         if len(theData) > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             outList.append(theData.mean())
 *             areaWeightedOutList.append(theData.mean()*len(theData))
 */
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_theData));<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_15 = ((__pyx_t_7 > 0) != 0);
    if (__pyx_t_15) {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line163")'> 163:             outList.append(theData.mean())</pre>
<pre id='line163' class='code' style='background-color: #FFFF5e'>
      /* "hist2d\fasthist.pyx":163
 *         theData=dataList[i]
 *         if len(theData) > 0:
 *             outList.append(theData.mean())             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             areaWeightedOutList.append(theData.mean()*len(theData))
 *             #print "appending: ",len(theData)
 */
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_theData), __pyx_n_s__mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_16 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_outList, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line164")'> 164:             areaWeightedOutList.append(theData.mean()*len(theData))</pre>
<pre id='line164' class='code' style='background-color: #FFFF39'>
      /* "hist2d\fasthist.pyx":164
 *         if len(theData) > 0:
 *             outList.append(theData.mean())
 *             areaWeightedOutList.append(theData.mean()*len(theData))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "appending: ",len(theData)
 *             gridCounts.append(len(theData))
 */
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_theData), __pyx_n_s__mean);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_theData));<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_16 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_areaWeightedOutList, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line165")'> 165:             #print "appending: ",len(theData)</pre>
<pre id='line165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line166")'> 166:             gridCounts.append(len(theData))</pre>
<pre id='line166' class='code' style='background-color: #FFFF5e'>
      /* "hist2d\fasthist.pyx":166
 *             areaWeightedOutList.append(theData.mean()*len(theData))
 *             #print "appending: ",len(theData)
 *             gridCounts.append(len(theData))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             outList.append(maskedValue)
 */
      __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_theData));<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_v_gridCounts, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:         else:</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line168")'> 168:             outList.append(maskedValue)</pre>
<pre id='line168' class='code' style='background-color: #FFFFaa'>
      /* "hist2d\fasthist.pyx":168
 *             gridCounts.append(len(theData))
 *         else:
 *             outList.append(maskedValue)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             areaWeightedOutList.append(maskedValue)
 *             gridCounts.append(0)
 */
      __pyx_t_16 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_outList, __pyx_v_maskedValue);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line169")'> 169:             areaWeightedOutList.append(maskedValue)</pre>
<pre id='line169' class='code' style='background-color: #FFFFaa'>
      /* "hist2d\fasthist.pyx":169
 *         else:
 *             outList.append(maskedValue)
 *             areaWeightedOutList.append(maskedValue)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             gridCounts.append(0)
 *     outVec=np.array(outList,dtype=np.float32)
 */
      __pyx_t_16 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_areaWeightedOutList, __pyx_v_maskedValue);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line170")'> 170:             gridCounts.append(0)</pre>
<pre id='line170' class='code' style='background-color: #FFFF9f'>
      /* "hist2d\fasthist.pyx":170
 *             outList.append(maskedValue)
 *             areaWeightedOutList.append(maskedValue)
 *             gridCounts.append(0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outVec=np.array(outList,dtype=np.float32)
 *     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)
 */
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_v_gridCounts, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line171")'> 171:     outVec=np.array(outList,dtype=np.float32)</pre>
<pre id='line171' class='code' style='background-color: #FFFF31'>
  /* "hist2d\fasthist.pyx":171
 *             areaWeightedOutList.append(maskedValue)
 *             gridCounts.append(0)
 *     outVec=np.array(outList,dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outList));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_outList));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_outList));
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_outVec = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line172")'> 172:     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)</pre>
<pre id='line172' class='code' style='background-color: #FFFF31'>
  /* "hist2d\fasthist.pyx":172
 *             gridCounts.append(0)
 *     outVec=np.array(outList,dtype=np.float32)
 *     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 *     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_areaWeightedOutList));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_v_areaWeightedOutList));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_areaWeightedOutList));
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, ((PyObject *)__pyx_n_s__dtype), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_v_outAreaWeightedVec = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line173")'> 173:     outArray=ma.masked_where(outVec==maskedValue,outVec)</pre>
<pre id='line173' class='code' style='background-color: #FFFF43'>
  /* "hist2d\fasthist.pyx":173
 *     outVec=np.array(outList,dtype=np.float32)
 *     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)
 *     gridCounts=np.array(gridCounts,dtype=np.int64)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__ma);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__masked_where);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_outVec, __pyx_v_maskedValue, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outVec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_outVec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_outVec);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_v_outArray = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line174")'> 174:     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)</pre>
<pre id='line174' class='code' style='background-color: #FFFF43'>
  /* "hist2d\fasthist.pyx":174
 *     outAreaWeightedVec=np.array(areaWeightedOutList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 *     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     gridCounts=np.array(gridCounts,dtype=np.int64)
 *     return (outArray,outAreaArray,gridCounts)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__ma);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__masked_where);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_outAreaWeightedVec, __pyx_v_maskedValue, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outAreaWeightedVec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_outAreaWeightedVec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_outAreaWeightedVec);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_v_outAreaArray = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line175")'> 175:     gridCounts=np.array(gridCounts,dtype=np.int64)</pre>
<pre id='line175' class='code' style='background-color: #FFFF30'>
  /* "hist2d\fasthist.pyx":175
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 *     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)
 *     gridCounts=np.array(gridCounts,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return (outArray,outAreaArray,gridCounts)
 * 
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_gridCounts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_gridCounts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_gridCounts);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_gridCounts);
  __pyx_v_gridCounts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line176")'> 176:     return (outArray,outAreaArray,gridCounts)</pre>
<pre id='line176' class='code' style='background-color: #FFFF1a'>
  /* "hist2d\fasthist.pyx":176
 *     outAreaArray=ma.masked_where(outAreaWeightedVec==maskedValue,outAreaWeightedVec)
 *     gridCounts=np.array(gridCounts,dtype=np.int64)
 *     return (outArray,outAreaArray,gridCounts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def findMedian(np.ndarray[float,ndim=1] dataVector, object indexList,maskedValue= -9999.):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outArray);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_outArray);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_outArray);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outAreaArray);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_outAreaArray);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_outAreaArray);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_gridCounts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_gridCounts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_gridCounts);
  __pyx_r = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.findMean", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dataVector);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dataList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_areaWeightedOutList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_gridCounts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_theData);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outAreaWeightedVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outArray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outAreaArray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dataVectorPy);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6hist2d_8fasthist_11findMedian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6hist2d_8fasthist_10findMedian[] = "findMedian(ndarray dataVector, indexList, maskedValue=-9999.0)\n\n    do a take of the indices in indexList to populate a new list of data\n    filled with dataVector values\n    ";
static PyMethodDef __pyx_mdef_6hist2d_8fasthist_11findMedian = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("findMedian"), (PyCFunction)__pyx_pw_6hist2d_8fasthist_11findMedian, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_6hist2d_8fasthist_10findMedian)};
static PyObject *__pyx_pw_6hist2d_8fasthist_11findMedian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_dataVector = 0;
  PyObject *__pyx_v_indexList = 0;
  PyObject *__pyx_v_maskedValue = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("findMedian (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__dataVector,&__pyx_n_s__indexList,&__pyx_n_s__maskedValue,0};
    PyObject* values[3] = {0,0,0};
    values[2] = __pyx_k_8;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dataVector)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__indexList)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("findMedian", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__maskedValue);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "findMedian") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dataVector = ((PyArrayObject *)values[0]);
    __pyx_v_indexList = values[1];
    __pyx_v_maskedValue = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("findMedian", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.findMedian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_dataVector), __pyx_ptype_5numpy_ndarray, 1, "dataVector", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6hist2d_8fasthist_10findMedian(__pyx_self, __pyx_v_dataVector, __pyx_v_indexList, __pyx_v_maskedValue);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177: </pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line178")'> 178: def findMedian(np.ndarray[float,ndim=1] dataVector, object indexList,maskedValue= -9999.):</pre>
<pre id='line178' class='code' style='background-color: #FFFF5b'>
/* "hist2d\fasthist.pyx":178
 *     return (outArray,outAreaArray,gridCounts)
 * 
 * def findMedian(np.ndarray[float,ndim=1] dataVector, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */

static PyObject *__pyx_pf_6hist2d_8fasthist_10findMedian(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_dataVector, PyObject *__pyx_v_indexList, PyObject *__pyx_v_maskedValue) {
  PyObject *__pyx_v_dataList = NULL;
  int __pyx_v_dataCount;
  int __pyx_v_i;
  PyObject *__pyx_v_outList = NULL;
  PyArrayObject *__pyx_v_theData = 0;
  PyObject *__pyx_v_outVec = NULL;
  PyObject *__pyx_v_outArray = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dataVector;
  __Pyx_Buffer __pyx_pybuffer_dataVector;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_theData;
  __Pyx_Buffer __pyx_pybuffer_theData;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("findMedian", 0);
  __pyx_pybuffer_theData.pybuffer.buf = NULL;
  __pyx_pybuffer_theData.refcount = 0;
  __pyx_pybuffernd_theData.data = NULL;
  __pyx_pybuffernd_theData.rcbuffer = &__pyx_pybuffer_theData;
  __pyx_pybuffer_dataVector.pybuffer.buf = NULL;
  __pyx_pybuffer_dataVector.refcount = 0;
  __pyx_pybuffernd_dataVector.data = NULL;
  __pyx_pybuffernd_dataVector.rcbuffer = &__pyx_pybuffer_dataVector;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer, (PyObject*)__pyx_v_dataVector, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_dataVector.diminfo[0].strides = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dataVector.diminfo[0].shape = __pyx_pybuffernd_dataVector.rcbuffer->pybuffer.shape[0];

  /* "hist2d\fasthist.pyx":178
 *     return (outArray,outAreaArray,gridCounts)
 * 
 * def findMedian(np.ndarray[float,ndim=1] dataVector, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(-9999.);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_8 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "hist2d\fasthist.pyx":178
 *     return (outArray,outAreaArray,gridCounts)
 * 
 * def findMedian(np.ndarray[float,ndim=1] dataVector, object indexList,maskedValue= -9999.):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """
 *     do a take of the indices in indexList to populate a new list of data
 */
  __pyx_k_tuple_33 = <span class='py_c_api'>PyTuple_Pack</span>(10, ((PyObject *)__pyx_n_s__dataVector), ((PyObject *)__pyx_n_s__indexList), ((PyObject *)__pyx_n_s__maskedValue), ((PyObject *)__pyx_n_s__dataList), ((PyObject *)__pyx_n_s__dataCount), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__outList), ((PyObject *)__pyx_n_s__theData), ((PyObject *)__pyx_n_s__outVec), ((PyObject *)__pyx_n_s__outArray));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_33);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_33));
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6hist2d_8fasthist_11findMedian, NULL, __pyx_n_s_24);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__findMedian, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179:     """</pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:     do a take of the indices in indexList to populate a new list of data</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:     filled with dataVector values</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:     """</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line183")'> 183:     dataList=takeValues(dataVector,indexList)</pre>
<pre id='line183' class='code' style='background-color: #FFFF5b'>
  /* "hist2d\fasthist.pyx":183
 *     filled with dataVector values
 *     """
 *     dataList=takeValues(dataVector,indexList)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int dataCount=len(dataList)
 *     cdef int i
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__takeValues);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_dataVector));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_dataVector));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_dataVector));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indexList);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_indexList);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_indexList);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_dataList = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line184")'> 184:     cdef int dataCount=len(dataList)</pre>
<pre id='line184' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":184
 *     """
 *     dataList=takeValues(dataVector,indexList)
 *     cdef int dataCount=len(dataList)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     outList=[]
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_dataList);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dataCount = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185:     cdef int i</pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line186")'> 186:     outList=[]</pre>
<pre id='line186' class='code' style='background-color: #FFFFaa'>
  /* "hist2d\fasthist.pyx":186
 *     cdef int dataCount=len(dataList)
 *     cdef int i
 *     outList=[]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):
 */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_v_outList = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187:     cdef np.ndarray[float,ndim=1] theData</pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188:     for i in range(dataCount):</pre>
<pre id='line188' class='code' style='background-color: #FFFFff'>
  /* "hist2d\fasthist.pyx":188
 *     outList=[]
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         theData=dataList[i]
 *         if len(theData) > 0:
 */
  __pyx_t_5 = __pyx_v_dataCount;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line189")'> 189:         theData=dataList[i]</pre>
<pre id='line189' class='code' style='background-color: #FFFF4d'>
    /* "hist2d\fasthist.pyx":189
 *     cdef np.ndarray[float,ndim=1] theData
 *     for i in range(dataCount):
 *         theData=dataList[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if len(theData) > 0:
 *             outList.append(np.median(theData))
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_dataList, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = ((PyArrayObject *)__pyx_t_3);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_8 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer, (PyObject*)__pyx_v_theData, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
        }
      }
      __pyx_pybuffernd_theData.diminfo[0].strides = __pyx_pybuffernd_theData.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theData.diminfo[0].shape = __pyx_pybuffernd_theData.rcbuffer->pybuffer.shape[0];
      if (unlikely(__pyx_t_8 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_theData));
    __pyx_v_theData = ((PyArrayObject *)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line190")'> 190:         if len(theData) &gt; 0:</pre>
<pre id='line190' class='code' style='background-color: #FFFFaa'>
    /* "hist2d\fasthist.pyx":190
 *     for i in range(dataCount):
 *         theData=dataList[i]
 *         if len(theData) > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             outList.append(np.median(theData))
 *         else:
 */
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_theData));<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = ((__pyx_t_4 > 0) != 0);
    if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line191")'> 191:             outList.append(np.median(theData))</pre>
<pre id='line191' class='code' style='background-color: #FFFF43'>
      /* "hist2d\fasthist.pyx":191
 *         theData=dataList[i]
 *         if len(theData) > 0:
 *             outList.append(np.median(theData))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             outList.append(maskedValue)
 */
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__median);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_theData));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_v_theData));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_theData));
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_outList, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line192")'> 192:         else:</pre>
<pre id='line192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line193")'> 193:             outList.append(maskedValue)</pre>
<pre id='line193' class='code' style='background-color: #FFFFaa'>
      /* "hist2d\fasthist.pyx":193
 *             outList.append(np.median(theData))
 *         else:
 *             outList.append(maskedValue)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outVec=np.array(outList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 */
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_outList, __pyx_v_maskedValue);<span class='error_goto'> if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line194")'> 194:     outVec=np.array(outList,dtype=np.float32)</pre>
<pre id='line194' class='code' style='background-color: #FFFF31'>
  /* "hist2d\fasthist.pyx":194
 *         else:
 *             outList.append(maskedValue)
 *     outVec=np.array(outList,dtype=np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 *     return outArray
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outList));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_outList));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_outList));
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
  __pyx_t_15 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_15) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_outVec = __pyx_t_15;
  __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line195")'> 195:     outArray=ma.masked_where(outVec==maskedValue,outVec)</pre>
<pre id='line195' class='code' style='background-color: #FFFF43'>
  /* "hist2d\fasthist.pyx":195
 *             outList.append(maskedValue)
 *     outVec=np.array(outList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return outArray
 * 
 */
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__ma);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s__masked_where);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_15 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_outVec, __pyx_v_maskedValue, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_15);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outVec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_outVec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_outVec);
  __pyx_t_15 = 0;
  __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_outArray = __pyx_t_15;
  __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line196")'> 196:     return outArray</pre>
<pre id='line196' class='code' style='background-color: #FFFF41'>
  /* "hist2d\fasthist.pyx":196
 *     outVec=np.array(outList,dtype=np.float32)
 *     outArray=ma.masked_where(outVec==maskedValue,outVec)
 *     return outArray             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * ## def findTemp(cnp.ndarray theta, cnp.ndarray press):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_outArray);
  __pyx_r = __pyx_v_outArray;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("hist2d.fasthist.findMedian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dataVector.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_theData.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dataList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_theData);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outVec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outArray);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getbuffer__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5numpy_7ndarray___getbuffer__(((PyArrayObject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info), ((int)__pyx_v_flags));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197: </pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198: ## def findTemp(cnp.ndarray theta, cnp.ndarray press):</pre>
<pre id='line198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199: ##     tempout=np.zeros([theta.size,])</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200: ##     cdef float* tempPtr=&lt;float*&gt;tempout.data</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201: ##     cdef int numRows=theta.shape[0]</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202: ##     cdef int numCols=theta.shape[1]</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203: ##     theta=theta.ravel()</pre>
<pre id='line203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204: ##     press=press.ravel()</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205: ##     cdef int i</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206: ##     cdef int numPts=theta.size</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: ##     cdef cnp.ndarray logtheta=np.log(theta)</pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208: ##     cdef float logP0=np.log(1.e5)</pre>
<pre id='line208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209: ##     cdef cnp.ndarray logP=np.log(press)</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210: ##     cdef float logTemp</pre>
<pre id='line210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211: ##     cdef float RdoCp=287./1004.</pre>
<pre id='line211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212: ##     print "in loop findTemp"</pre>
<pre id='line212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213: ##     for i in range(numPts):</pre>
<pre id='line213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214: ##         tempout[i]=logtheta[i] - RdoCp*(logP0 - logP[i])</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215: ##     tempout=np.exp(tempout)</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216: ##     return tempout</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'></pre></body></html>
